{
    "policies": [
        {
            "name": "message_routing",
            "config": {
                "allowed_component_pairs": [
                    {"source": "fl_server", "target": "fl_client"},
                    {"source": "fl_client", "target": "fl_server"},
                    {"source": "fl_server", "target": "sdn_controller"},
                    {"source": "sdn_controller", "target": "fl_server"},
                    {"source": "fl_client", "target": "policy_engine"},
                    {"source": "fl_server", "target": "policy_engine"},
                    {"source": "sdn_controller", "target": "policy_engine"},
                    {"source": "fl_client", "target": "sdn_controller"},
                    {"source": "*", "target": "policy_engine"}
                ],
                "restricted_messages": [
                    "model_update",
                    "aggregated_model",
                    "client_selection",
                    "network_config"
                ],
                "message_priorities": {
                    "model_distribution": "high",
                    "model_update": "high",
                    "aggregated_model": "high",
                    "heartbeat": "low",
                    "status_update": "low",
                    "client_selection": "medium",
                    "network_config": "high"
                }
            },
            "rules": [
                {
                    "name": "allow_all_policy_engine_messages",
                    "condition": {
                        "type": "or",
                        "conditions": [
                            {
                                "type": "simple",
                                "field": "source_component",
                                "operator": "eq",
                                "value": "policy_engine"
                            },
                            {
                                "type": "simple",
                                "field": "target_component",
                                "operator": "eq",
                                "value": "policy_engine"
                            }
                        ]
                    },
                    "action": {
                        "type": "allow",
                        "reason": "Policy engine messages are always allowed"
                    }
                },
                {
                    "name": "block_unauthorized_model_updates",
                    "condition": {
                        "type": "and",
                        "conditions": [
                            {
                                "type": "simple",
                                "field": "message_type",
                                "operator": "eq",
                                "value": "model_update"
                            },
                            {
                                "type": "simple",
                                "field": "target_component",
                                "operator": "neq",
                                "value": "fl_server"
                            }
                        ]
                    },
                    "action": {
                        "type": "deny",
                        "reason": "Model updates must be sent to FL server only"
                    }
                }
            ]
        },
        {
            "name": "message_delivery",
            "config": {
                "rate_limits": {
                    "model_update": 20,
                    "aggregated_model": 5,
                    "heartbeat": 60,
                    "status_update": 30
                },
                "component_subscriptions": {
                    "fl_client": ["model_distribution", "aggregated_model", "client_selection", "network_config"],
                    "fl_server": ["model_update", "heartbeat", "status_update", "client_registration"],
                    "sdn_controller": ["network_stats", "topology_update", "flow_stats", "network_config"],
                    "policy_engine": ["*"]
                },
                "priorities": {
                    "high": ["model_distribution", "model_update", "aggregated_model", "network_config"],
                    "medium": ["client_selection", "network_stats", "client_registration"],
                    "low": ["heartbeat", "status_update", "topology_update"]
                }
            },
            "rules": [
                {
                    "name": "policy_engine_unlimited",
                    "condition": {
                        "type": "simple",
                        "field": "target_component",
                        "operator": "eq",
                        "value": "policy_engine"
                    },
                    "action": {
                        "type": "allow",
                        "reason": "Policy engine has no delivery restrictions"
                    }
                }
            ]
        }
    ]
} 